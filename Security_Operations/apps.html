<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CySA+ Tools â€” Essentials Drag & Match</title>
<style>
  :root{--bg:#0d1117;--card:#161b22;--ink:#e6edf3;--muted:#9fb1c3;--border:#263042;--ok:#2ea043;--bad:#ff6b6b;--chip:#121821}
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  header{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;margin-bottom:12px}
  h1{font-size:18px;margin:0;font-weight:700}
  .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  select,.btn{background:#1b2230;border:1px solid var(--border);color:var(--ink);padding:8px 10px;border-radius:10px;font-weight:600}
  .grid{display:grid;gap:12px} @media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
  .col{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
  .col h2{font-size:13px;color:var(--muted);margin:0 0 8px}
  .list,.targets{display:grid;gap:10px}
  .item{border:1px solid var(--border);border-radius:10px;background:var(--chip);padding:10px 12px;font-weight:700;user-select:none;touch-action:none;cursor:grab;display:flex;justify-content:space-between}
  .abbr{font-size:12px;color:#9cc1ff;background:#0f1722;border:1px solid #23324a;border-radius:999px;padding:2px 8px}
  .target{background:var(--chip);border:1px solid var(--border);border-radius:10px;padding:10px 12px;transition:outline .25s ease,box-shadow .25s ease}
  .desc{font-size:14px}
  .is-correct{outline:2px solid var(--ok);box-shadow:0 0 6px rgba(46,160,67,.4)}
  .flash-wrong{animation:wrong .4s ease}
  @keyframes wrong{0%{outline:2px solid transparent}30%,70%{outline:2px solid var(--bad)}100%{outline:2px solid transparent}}
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:10}
  .popup{background:#161b22;padding:26px 30px;border-radius:14px;text-align:center;box-shadow:0 0 18px rgba(46,160,67,.35)}
  .popup h2{color:var(--ok);margin:0 0 8px;font-size:22px}
  .popup button{background:var(--ok);color:#fff;border:none;padding:8px 14px;border-radius:10px;font-weight:700;cursor:pointer}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>CySA+ Tools â€” Essentials</h1>
    <div class="controls">
      <select id="stage">
        <option value="forensics">Forensics (5)</option>
        <option value="network">Network (5)</option>
        <option value="web">Web (5)</option>
        <option value="siem">SIEM & Endpoint (5)</option>
      </select>
      <button class="btn" id="resetBtn">Reset</button>
    </div>
  </header>

  <section class="grid">
    <div class="col">
      <h2>Tools</h2>
      <div class="list" id="list"></div>
    </div>
    <div class="col">
      <h2>Descriptions</h2>
      <div class="targets" id="targets"></div>
    </div>
  </section>
</div>

<script>
const STAGES = {
  forensics: [
    {id:"autopsy", term:"Autopsy / Sleuth Kit", abbr:"disk", desc:"Disk forensics: filesystem analysis, carving, timelines."},
    {id:"vol", term:"Volatility", abbr:"memory", desc:"Memory forensics: processes, handles, netscan from RAM."},
    {id:"ftk", term:"FTK Imager", abbr:"image", desc:"Acquire/verify forensic images; preview evidence."},
    {id:"regrip", term:"RegRipper", abbr:"registry", desc:"Parse Windows Registry hives to extract artifacts."},
    {id:"strings", term:"strings", abbr:"artefacts", desc:"Extract printable strings from binaries/mem dumps."},
  ],
  network: [
    {id:"wireshark", term:"Wireshark", abbr:"pcap", desc:"Interactive packet analysis with dissectors."},
    {id:"tcpdump", term:"tcpdump", abbr:"cli pcap", desc:"CLI capture & filter packets (BPF)."},
    {id:"zeek", term:"Zeek (Bro)", abbr:"nsmd", desc:"Network security monitor producing rich logs."},
    {id:"nmap", term:"Nmap", abbr:"scan", desc:"Port/service scan; version/NSE scripting."},
    {id:"suricata", term:"Suricata", abbr:"ids/ips", desc:"IDS/IPS/NSM engine; EVE JSON output."},
  ],
  web: [
    {id:"burp", term:"Burp Suite", abbr:"proxy", desc:"Intercepting proxy + scanner for web testing."},
    {id:"zap", term:"OWASP ZAP", abbr:"oss proxy", desc:"Open-source proxy/scanner for web vulns."},
    {id:"sqlmap", term:"sqlmap", abbr:"sqli", desc:"Automated SQL injection detection/exploit."},
    {id:"ffuf", term:"ffuf", abbr:"fuzz", desc:"Fast fuzzer for dirs/params/vhosts."},
    {id:"gobuster", term:"gobuster", abbr:"enum", desc:"Brute-force directories/DNS/vhosts."},
  ],
  siem: [
    {id:"splunk", term:"Splunk", abbr:"siem", desc:"Ingest/search logs; detections & dashboards."},
    {id:"elk", term:"Elastic (ELK)", abbr:"oss siem", desc:"Elasticsearch + Logstash + Kibana analytics."},
    {id:"sysmon", term:"Sysmon", abbr:"win logs", desc:"Windows telemetry: processes, network, image loads."},
    {id:"osquery", term:"osquery", abbr:"sql host", desc:"Query endpoint state via SQL tables."},
    {id:"wazuh", term:"Wazuh", abbr:"xdr", desc:"Open-source XDR/SIEM with agents and rules."},
  ],
};

const listEl = document.getElementById('list');
const targetsEl = document.getElementById('targets');
const stageSel = document.getElementById('stage');
const resetBtn = document.getElementById('resetBtn');

let placed = new Map();
let selectedChip = null;

function shuffle(a){const b=a.slice();for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]]}return b}
function pairs(){ return STAGES[stageSel.value] || []; }

function init(){
  placed.clear(); selectedChip=null;
  listEl.innerHTML=''; targetsEl.innerHTML='';
  for(const p of shuffle(pairs())){
    const chip=document.createElement('div');
    chip.className='item'; chip.dataset.id=p.id;
    chip.innerHTML=`<span>${p.term}</span><span class="abbr">${p.abbr}</span>`;
    enablePointerDrag(chip);
    chip.addEventListener('click', ()=>{
      if(chip.classList.contains('ghost'))return;
      const on = chip.classList.contains('sel');
      document.querySelectorAll('.item').forEach(c=>c.classList.remove('sel'));
      if(!on){ chip.classList.add('sel'); selectedChip=chip; } else { selectedChip=null; }
    });
    listEl.appendChild(chip);
  }
  for(const p of shuffle(pairs())){
    const box=document.createElement('div');
    box.className='target'; box.dataset.id=p.id;
    box.innerHTML=`<div class="desc">${p.desc}</div>`;
    box.addEventListener('click', ()=>{
      if(!selectedChip) return;
      check(selectedChip.dataset.id, box, selectedChip);
      selectedChip=null; document.querySelectorAll('.item').forEach(c=>c.classList.remove('sel'));
    });
    targetsEl.appendChild(box);
  }
}

function check(id, box, chip){
  if(placed.has(box.dataset.id)) return;
  if(id===box.dataset.id){
    placed.set(id,true);
    box.classList.add('is-correct');
    chip.style.pointerEvents='none'; chip.style.opacity='.4'; chip.classList.add('ghost');
    if(placed.size===pairs().length) congrats();
  }else{
    box.classList.add('flash-wrong');
    setTimeout(()=>box.classList.remove('flash-wrong'),400);
  }
}

function congrats(){
  const overlay=document.createElement('div'); overlay.className='overlay';
  /* FIX: use this.closest('.overlay') so the handler has scope */
  overlay.innerHTML=`<div class="popup">
    <h2>ðŸŽ‰ Nice work!</h2>
    <p>All matches complete.</p>
    <button onclick="this.closest('.overlay').remove();init()">Replay</button>
  </div>`;
  document.body.appendChild(overlay);
}

/* Pointer-drag (mobile friendly) */
function enablePointerDrag(chip){
  let dragging=false, clone=null, offX=0, offY=0;
  chip.addEventListener('pointerdown', e=>{
    if(chip.classList.contains('ghost')) return;
    dragging=true; chip.setPointerCapture(e.pointerId);
    const r=chip.getBoundingClientRect(); offX=e.clientX-r.left; offY=e.clientY-r.top;
    clone=chip.cloneNode(true); Object.assign(clone.style,{
      position:'fixed',left:(e.clientX-offX)+'px',top:(e.clientY-offY)+'px',width:r.width+'px',
      zIndex:9999,opacity:.95,pointerEvents:'none'
    }); document.body.appendChild(clone);
  });
  window.addEventListener('pointermove', e=>{
    if(!dragging||!clone) return;
    clone.style.left=(e.clientX-offX)+'px'; clone.style.top=(e.clientY-offY)+'px';
  },{passive:true});
  window.addEventListener('pointerup', e=>{
    if(!dragging) return; dragging=false;
    if(clone){
      const el=document.elementFromPoint(e.clientX,e.clientY);
      const target=el?el.closest('.target'):null;
      if(target) check(chip.dataset.id, target, chip);
      clone.remove(); clone=null;
    }
    try{chip.releasePointerCapture(e.pointerId);}catch{}
  },{passive:true});
}

stageSel.addEventListener('change', init);
resetBtn.addEventListener('click', init);
init();
</script>
</body>
</html>
