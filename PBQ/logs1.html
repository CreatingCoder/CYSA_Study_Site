<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CySA+ Log Reading Practice — 50 Questions</title>
<style>
  :root{
    --bg:#0d1117; --card:#161b22; --ink:#e6edf3;
    --muted:#9da5b4; --good:#2ecc71; --bad:#e74c3c;
    --radius:14px;
  }
  body{
    margin:0;
    padding:16px;
    background:var(--bg);
    color:var(--ink);
    font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }
  h1{
    text-align:center;
    margin-bottom:10px;
  }
  #meta{
    text-align:center;
    color:var(--muted);
    margin-bottom:18px;
    font-size:0.9rem;
  }
  .question-card{
    background:var(--card);
    border-radius:var(--radius);
    padding:12px 14px;
    margin-bottom:14px;
    box-shadow:0 0 0 1px #202635;
  }
  .q-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:6px;
    font-size:0.9rem;
    color:var(--muted);
  }
  pre{
    background:#0a1018;
    border-radius:10px;
    padding:8px;
    overflow-x:auto;
    font-size:0.8rem;
    margin:6px 0 10px;
  }
  .q-text{
    margin:4px 0 10px;
    font-size:0.95rem;
  }
  .options{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .opt-btn{
    border-radius:999px;
    border:none;
    padding:8px 10px;
    font-size:0.9rem;
    text-align:left;
    background:#1f2634;
    color:var(--ink);
    cursor:pointer;
    transition:background 0.15s, transform 0.05s;
  }
  .opt-btn:hover{
    transform:translateY(-1px);
  }
  .opt-btn.correct{
    background:var(--good);
    color:#041208;
  }
  .opt-btn.wrong{
    background:var(--bad);
  }
  .feedback{
    margin-top:6px;
    font-size:0.85rem;
  }
  .feedback.correct{color:var(--good);}
  .feedback.wrong{color:var(--bad);}
  @media (max-width:600px){
    body{padding:10px;}
    .question-card{padding:10px;}
  }
</style>
</head>
<body>

<h1>CySA+ Log Reading Practice</h1>
<div id="meta">50 questions • order randomizes each time you load the page</div>

<div id="quiz"></div>

<script>
// 10 base scenarios, then we clone them with different dates to make 50 total.
// IMPORTANT: avoid writing the exact closing script tag text inside this code.

const baseQuestions = [
  {
    log: `Feb 04 09:01:11 web01 sshd[1245]: Failed password for invalid user admin from 203.0.113.45 port 52134 ssh2
Feb 04 09:01:13 web01 sshd[1247]: Failed password for invalid user admin from 203.0.113.45 port 52136 ssh2
Feb 04 09:01:16 web01 sshd[1250]: Failed password for invalid user admin from 203.0.113.45 port 52140 ssh2`,
    question: "What activity best describes this log sequence?",
    options: [
      "Normal administrator login attempts",
      "SSH brute-force attack",
      "Port scan",
      "Privilege escalation on the local host"
    ],
    answer: 1
  },
  {
    log: `Feb 04 10:15:22 fw01 kernel: IN=eth0 OUT= MAC=00:0c:29:aa:bb:cc SRC=198.51.100.77 DST=10.10.10.20 LEN=60 TOS=0x00 PREC=0x00 TTL=52 ID=54321 DF PROTO=TCP SPT=41523 DPT=22 WINDOW=64240 SYN
Feb 04 10:15:23 fw01 kernel: IN=eth0 OUT= SRC=198.51.100.77 DST=10.10.10.20 PROTO=TCP SPT=41523 DPT=23 SYN
Feb 04 10:15:24 fw01 kernel: IN=eth0 OUT= SRC=198.51.100.77 DST=10.10.10.20 PROTO=TCP SPT=41523 DPT=80 SYN
Feb 04 10:15:25 fw01 kernel: IN=eth0 OUT= SRC=198.51.100.77 DST=10.10.10.20 PROTO=TCP SPT=41523 DPT=443 SYN`,
    question: "What is the most likely activity?",
    options: [
      "Web application fuzzing",
      "DNS poisoning attack",
      "TCP port scan",
      "Legitimate multi-service monitoring"
    ],
    answer: 2
  },
  {
    log: `192.0.2.15 - - [04/Feb/2025:11:02:10 +0000] "GET /wp-login.php HTTP/1.1" 401 512 "-" "Mozilla/5.0"
192.0.2.15 - - [04/Feb/2025:11:02:12 +0000] "POST /wp-login.php HTTP/1.1" 401 512 "-" "Mozilla/5.0"
192.0.2.15 - - [04/Feb/2025:11:02:14 +0000] "POST /wp-login.php HTTP/1.1" 401 512 "-" "Mozilla/5.0"
192.0.2.15 - - [04/Feb/2025:11:02:20 +0000] "POST /wp-login.php HTTP/1.1" 200 1024 "-" "Mozilla/5.0"`,
    question: "What is the BEST description of the attack pattern shown?",
    options: [
      "Password spraying / brute-force against a web login",
      "SQL injection against the database backend",
      "Cross-site request forgery",
      "Normal user login with 2FA retries"
    ],
    answer: 0
  },
  {
    // XSS log uses encoded characters instead of a raw tag in the URL
    log: `203.0.113.88 - - [04/Feb/2025:12:33:41 +0000] "GET /search.php?q=%3Cscript%3Ealert(1)%3C/script%3E HTTP/1.1" 400 298 "-" "Mozilla/5.0"`,
    question: "What type of attack is MOST likely represented by this request?",
    options: [
      "Command injection",
      "Cross-site scripting (XSS) attempt",
      "Directory traversal",
      "Server-side request forgery"
    ],
    answer: 1
  },
  {
    log: `Feb 04 13:11:08 ids01 snort[2222]: [1:2010935:4] ET POLICY DNS TUNNEL Possible DNS Tunneling Detected [Classification: Potential Corporate Privacy Violation] [Priority: 1] {UDP} 10.10.5.25:52341 -> 8.8.8.8:53
Feb 04 13:11:09 ids01 snort[2222]: [1:2010935:4] ET POLICY DNS TUNNEL Possible DNS Tunneling Detected {UDP} 10.10.5.25:52341 -> 8.8.8.8:53`,
    question: "What is the MOST likely concern based on these IDS alerts?",
    options: [
      "DNS cache poisoning",
      "DNS amplification attack",
      "DNS tunneling for data exfiltration",
      "Normal DNS resolution traffic"
    ],
    answer: 2
  },
  {
    log: `Feb 04 14:22:10 proxy01 http-proxy[4455]: 10.20.30.40 - HR-LAPTOP12 "POST http://198.51.100.200/upload HTTP/1.1" 200 52428800 "-" "curl/7.68.0"
Feb 04 14:22:11 proxy01 http-proxy[4455]: Note: Uploaded 50MB to external host 198.51.100.200`,
    question: "What is the MOST likely security issue indicated here?",
    options: [
      "Normal software update",
      "Data exfiltration over HTTP",
      "NTP misconfiguration",
      "Malicious DNS zone transfer"
    ],
    answer: 1
  },
  {
    log: `192.0.2.44 - - [04/Feb/2025:15:07:55 +0000] "GET /app.php?id=10 HTTP/1.1" 200 2048 "-" "Mozilla/5.0"
192.0.2.44 - - [04/Feb/2025:15:07:58 +0000] "GET /app.php?id=10%20OR%201%3D1-- HTTP/1.1" 500 4096 "-" "Mozilla/5.0"`,
    question: "Which attack type BEST matches this log entry?",
    options: [
      "SQL injection",
      "LDAP injection",
      "XSS",
      "Clickjacking"
    ],
    answer: 0
  },
  {
    log: `Feb 04 16:00:01 dns01 named[1337]: client 10.10.5.99#49152: query: asd98as9d8as9d.asd9as8d9as9d.example.com IN A + (10.10.5.99)
Feb 04 16:00:02 dns01 named[1337]: client 10.10.5.99#49152: query: qwe98qwe98qwe98qwe.example.com IN A + (10.10.5.99)
Feb 04 16:00:03 dns01 named[1337]: client 10.10.5.99#49152: query: zxcvzxcvzxcv123123.example.com IN A + (10.10.5.99)`,
    question: "What is the MOST likely explanation for these DNS queries?",
    options: [
      "Benign content delivery network lookups",
      "Domain generation algorithm (DGA) malware activity",
      "User typo-squatting",
      "Routine zone transfer testing"
    ],
    answer: 1
  },
  {
    log: `An account failed to log on.
Subject: Security ID: S-1-0-0
Logon Type: 2
Account For Which Logon Failed: Account Name: jdoe
Failure Information: Failure Reason: Unknown user name or bad password.

An account was successfully logged on.
Subject: Security ID: CORP\\jdoe
Logon Type: 10
Network Information: Workstation Name: HR-PC01

A member was added to a security-enabled local group.
Subject: Security ID: CORP\\jdoe
Target Account: Administrators`,
    question: "What security concern is MOST indicated by this Windows event sequence?",
    options: [
      "Normal user password reset",
      "Pass-the-hash lateral movement and privilege escalation",
      "Service account rotation",
      "Kerberos ticket renewal"
    ],
    answer: 1
  },
  {
    log: `Feb 04 18:45:12 filesrv01 antivirus: Detected: Ransom.Win32.Locky in C:\\Users\\jdoe\\Documents\\invoice.doc
Feb 04 18:45:30 filesrv01 system: Many files renamed with extension .locky under \\\\fileshare\\Finance
Feb 04 18:45:45 filesrv01 system: User jdoe session disconnected`,
    question: "What is the MOST likely incident type?",
    options: [
      "Wiper malware destroying the boot sector",
      "Ransomware outbreak encrypting file shares",
      "Benign file sync process",
      "Misconfigured backup process"
    ],
    answer: 1
  }
];

// Expand to 50 questions by cloning base with slight date tweaks
let questions = [];
for(let i = 0; i < 5; i++){ // 5 * 10 = 50
  baseQuestions.forEach((q, idx) => {
    const day = String(4 + i).padStart(2, "0"); // 04..08
    const clonedLog = q.log.replace("Feb 04", `Feb ${day}`);
    questions.push({
      log: clonedLog,
      question: q.question,
      options: q.options,
      answer: q.answer
    });
  });
}

// Fisher–Yates shuffle
function shuffle(array){
  for(let i = array.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

shuffle(questions);

const quizEl = document.getElementById("quiz");

questions.forEach((q, idx) => {
  const card = document.createElement("div");
  card.className = "question-card";

  const header = document.createElement("div");
  header.className = "q-header";
  header.innerHTML = `<span>Question ${idx + 1} of ${questions.length}</span>`;
  card.appendChild(header);

  const pre = document.createElement("pre");
  pre.textContent = q.log; // textContent keeps it safe
  card.appendChild(pre);

  const qtext = document.createElement("div");
  qtext.className = "q-text";
  qtext.textContent = q.question;
  card.appendChild(qtext);

  const opts = document.createElement("div");
  opts.className = "options";

  const feedback = document.createElement("div");
  feedback.className = "feedback";
  feedback.textContent = "";
  card.appendChild(opts);
  card.appendChild(feedback);

  q.options.forEach((optText, optIdx) => {
    const btn = document.createElement("button");
    btn.className = "opt-btn";
    btn.type = "button";
    btn.textContent = optText;

    btn.addEventListener("click", () => {
      // If already answered correctly, ignore
      if(feedback.classList.contains("correct")) return;

      if(optIdx === q.answer){
        btn.classList.add("correct");
        feedback.className = "feedback correct";
        feedback.textContent = "Correct!";
      } else {
        btn.classList.add("wrong");
        feedback.className = "feedback wrong";
        feedback.textContent = "Incorrect. Try again.";
      }
    });

    opts.appendChild(btn);
  });

  quizEl.appendChild(card);
});
</script>

</body>
</html>
